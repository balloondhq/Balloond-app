# Render Deployment Guide for Balloon'd

## Fixed Issues from Error Log

The deployment errors have been fixed:
1. ✅ Corrected package versions (aws-sdk, firebase-admin, etc.)
2. ✅ Added NestJS CLI to dependencies
3. ✅ Created proper build scripts
4. ✅ Fixed build command structure

## Deploy to Render - Step by Step

### 1. Prepare Your Repository

```bash
# In your local repository
cd C:\Users\disha\Documents\GitHub\balloond-app

# Commit the fixed files
git add .
git commit -m "Fix deployment issues for Render"
git push origin main
```

### 2. Environment Variables on Render

Go to your Render dashboard and add these environment variables:

```env
# Required Variables
NODE_ENV=production
PORT=8000

# Database (Render will auto-generate this)
DATABASE_URL=<auto-generated-by-render>

# Generate these secrets
JWT_SECRET=<generate-with: openssl rand -base64 32>
JWT_REFRESH_SECRET=<generate-with: openssl rand -base64 32>
ENCRYPTION_KEY=<generate-with: openssl rand -hex 16>

# Redis (if using Render Redis)
REDIS_URL=<auto-generated-by-render>

# Optional for MVP (add later)
AWS_ACCESS_KEY_ID=<your-aws-key>
AWS_SECRET_ACCESS_KEY=<your-aws-secret>
STRIPE_SECRET_KEY=<your-stripe-key>
```

### 3. Update Build & Start Commands in Render

In your Render service settings:

**Build Command:**
```bash
cd backend && npm install && npx prisma generate && npm run build
```

**Start Command:**
```bash
cd backend && node dist/main
```

### 4. Database Setup

1. Create a PostgreSQL database on Render
2. It will automatically provide DATABASE_URL
3. Run migrations after first deploy:
```bash
cd backend && npx prisma migrate deploy
```

## Alternative: Deploy with Docker

If the Node.js deployment continues to have issues, use Docker:

### 1. Update Render Settings
- Change Environment to "Docker"
- Render will automatically detect the Dockerfile

### 2. The Dockerfile handles everything:
- Installing dependencies
- Building the app
- Running in production

## Quick Fix Script

Run this locally to ensure everything is correct:

```bash
# Install and build locally to test
cd backend
npm install
npx prisma generate
npm run build

# If successful, commit and push
git add .
git commit -m "Verified build locally"
git push
```

## Common Issues & Solutions

### Issue: "nest: not found"
**Solution:** Already fixed - NestJS CLI added to dependencies

### Issue: Package version errors
**Solution:** Already fixed - Updated to valid versions

### Issue: Build fails
**Solution:** Use the Docker deployment option

### Issue: Database connection fails
**Solution:** Ensure DATABASE_URL includes `?schema=public` at the end

## Minimal Deployment (MVP)

For a quick MVP deployment, you only need:

1. **Database**: Render PostgreSQL (free tier)
2. **Backend API**: This repository
3. **Environment Variables**: Only the required ones above

You can add these later:
- Redis caching
- AWS S3 for images
- Stripe payments
- Push notifications

## Test Your Deployment

After deployment, test these endpoints:

```bash
# Health check
curl https://your-app.onrender.com/api/health

# API documentation
open https://your-app.onrender.com/api/docs
```

## Support

If you encounter issues:
1. Check Render logs: Dashboard → Logs
2. Verify environment variables are set
3. Ensure database is connected
4. Try the Docker deployment option

Your app should now deploy successfully on Render!
